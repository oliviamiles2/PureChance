# PureChance

PureChance is a privacy-first on-chain lottery built on Zama's FHEVM. Players buy a ticket for 0.001 ETH, pick two numbers (1-9) that stay encrypted on-chain, then start a draw that produces encrypted random numbers and encrypted rewards. Scores are stored and shown as encrypted values, and the frontend provides a one-click decryption flow for the player.

This project focuses on proving that a simple, transparent game can still keep user picks, draws, and rewards confidential while remaining verifiable and trust-minimized.

## Overview

- Ticket purchase encrypts two numbers and stores them without revealing plaintext.
- A draw generates two encrypted random numbers on-chain.
- Rewards are encrypted and added to the player's encrypted score.
- Frontend shows the encrypted score and allows the player to decrypt it.

## Game Rules

- Ticket price: 0.001 ETH.
- Two numbers are selected, each in the range 1-9.
- One match earns 10 points, two matches earn 100 points.
- Points are encrypted and never stored in plaintext on-chain.

## Problems Solved

- Prevents public exposure of player picks and results.
- Avoids easy copy-trading or mempool snooping of lottery picks.
- Preserves on-chain transparency while keeping sensitive game data confidential.
- Provides verifiable encrypted scoring that can be decrypted only by the player.

## Advantages

- Confidentiality: picks, draws, and scores remain encrypted end-to-end.
- Fairness: on-chain randomness and deterministic encrypted scoring.
- Simplicity: a small, auditable contract surface with a clear user flow.
- Composability: can be extended into multi-round games or reward systems.

## How It Works (FHE Flow)

1. The frontend uses the Zama relayer SDK to encrypt the two picks.
2. The contract stores encrypted picks and grants access to the player.
3. The player starts the draw; the contract generates encrypted randomness.
4. The contract compares encrypted picks to encrypted draws and updates the encrypted score.
5. The frontend reads the encrypted score and decrypts it for the player.

## Tech Stack

- Smart contracts: Solidity 0.8.x + Zama FHEVM libraries
- Framework: Hardhat, hardhat-deploy
- Frontend: React + Vite
- Wallet UX: RainbowKit + wagmi
- Chain access: viem (read), ethers (write)
- Encryption/Decryption: Zama relayer SDK
- Tooling: TypeScript, ESLint, Prettier

## Repository Layout

- `contracts/`: Solidity contracts (main contract: `PureChance.sol`)
- `deploy/`: Deployment scripts
- `tasks/`: Hardhat tasks
- `test/`: Contract tests
- `deployments/`: Network deployments and ABIs (frontend uses `deployments/sepolia` ABI)
- `src/`: Frontend app (React + Vite)
- `docs/`: Local Zama references

## Key Constraints (Project Rules)

- Do not use Tailwind CSS.
- Frontend reads must use viem; writes must use ethers.
- Frontend does not use localStorage and does not target localhost networks.
- Frontend does not use environment variables and does not load JSON files.
- Frontend must only use ABI generated by the contract, copied from `deployments/sepolia`.
- Contracts and comments are written in English only.

## Setup

### Prerequisites

- Node.js 20+
- npm 7+

### Install (root)

```bash
npm install
```

### Compile and Test

```bash
npm run compile
npm run test
```

## Environment Configuration

Create `.env` at the repository root with:

- `INFURA_API_KEY`
- `PRIVATE_KEY`
- Optional: `ETHERSCAN_API_KEY`

Note: deployment uses a private key only. Do not use a mnemonic.

## Deploy

Run tests and tasks locally, then deploy to Sepolia:

```bash
npm run deploy:sepolia
```

After deployment:

- Copy the ABI from `deployments/sepolia` into the frontend contract config.
- Ensure the frontend points to Sepolia and uses the deployed contract address.

## Frontend Usage

1. Install frontend dependencies from `src/`.
2. Connect a wallet on Sepolia.
3. Encrypt picks, buy a ticket, and start the draw.
4. View the encrypted score and decrypt it in the UI.

## Future Roadmap

- Multiple concurrent tickets and round history per player.
- Configurable payouts and jackpot mechanics.
- Better randomness transparency and verifiable draw metadata.
- Gas optimization and formal security review.
- Multi-network deployments beyond Sepolia.
- Improved UI/UX for encrypted data education.

## License

BSD-3-Clause-Clear. See `LICENSE`.
